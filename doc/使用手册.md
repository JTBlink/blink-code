# Aider 使用手册

## 简介

Aider 是一个基于大语言模型（LLM）的命令行工具，可以帮助您编辑代码。通过与 LLM 的对话，您可以要求它进行各种代码修改，而 Aider 会自动将这些修改应用到您的源文件中。

## 安装说明

### 系统要求
- Python 3.7 或更高版本
- Git（推荐）
- 访问 LLM API 的密钥（如 OpenAI、Anthropic 等）

### 安装步骤
1. 使用 pip 安装：
   ```
   pip install aider-chat
   ```

2. 或者从源码安装最新版本：
   ```
   pip install git+https://github.com/paul-gauthier/aider.git
   ```

3. 验证安装：
   ```
   aider --help
   ```

## 快速开始

### 设置 API 密钥
在使用 Aider 之前，您需要设置相应的 API 密钥：

1. 对于 OpenAI API（支持 GPT 模型）：
   ```bash
   export OPENAI_API_KEY=您的密钥
   ```

2. 对于 Anthropic API（支持 Claude 模型）：
   ```bash
   export ANTHROPIC_API_KEY=您的密钥
   ```

您也可以使用命令行参数直接提供 API 密钥：
```bash
aider --openai-api-key=您的OpenAI密钥
aider --anthropic-api-key=您的Anthropic密钥
```

或者在配置文件中设置（`.aider.conf.yml`）。

### 基本用法

1. 打开一个代码文件：
   ```bash
   aider 文件路径1 文件路径2 ...
   ```

2. 启动与特定模型的对话：
   ```bash
   aider --model gpt-4o 文件路径
   ```

3. 在对话中，您可以向 AI 描述您想要对代码进行的修改，Aider 会自动应用这些修改。

4. 使用 `/help` 命令查看可用的对话命令。

## 模型选择

Aider 支持多种 LLM：

- OpenAI 模型：GPT-4o、GPT-4-Turbo、GPT-3.5-Turbo 等
- Anthropic 模型：Claude 3 Opus、Claude 3 Sonnet、Claude 3 Haiku 等
- 其他模型：请参阅 `--list-models` 命令

选择模型的方法：
```bash
aider --model 模型名称
```

## 命令行选项详解

### 主要选项

- `--model MODEL`：指定要使用的 LLM 模型
- `--file FILE`：指定要编辑的文件（可多次使用）
- `--read FILE`：指定只读文件（可多次使用）
- `-m, --message COMMAND`：发送单条消息给 LLM，处理回复后退出
- `--gui, --browser`：在浏览器中运行 Aider

### API 设置

- `--openai-api-key OPENAI_API_KEY`：指定 OpenAI API 密钥
- `--anthropic-api-key ANTHROPIC_API_KEY`：指定 Anthropic API 密钥
- `--openai-api-base OPENAI_API_BASE`：指定 API 基础 URL
- `--api-key PROVIDER=KEY`：为提供商设置 API 密钥

### Git 设置

- `--git, --no-git`：启用/禁用 Git 仓库查找
- `--auto-commits, --no-auto-commits`：启用/禁用 LLM 更改的自动提交
- `--commit`：提交所有待处理的更改并附带合适的提交消息，然后退出

### 输出设置

- `--dark-mode`：使用适合深色终端背景的颜色
- `--light-mode`：使用适合浅色终端背景的颜色
- `--pretty, --no-pretty`：启用/禁用美化彩色输出
- `--stream, --no-stream`：启用/禁用流式响应

### 其他设置

- `--lint`：对提供的文件或脏文件进行 lint 和修复
- `--test`：运行测试，修复发现的问题然后退出
- `--show-diffs`：提交更改时显示差异
- `--verbose, -v`：启用详细输出

## 常见使用场景

### 修复 Bug

```bash
aider 有问题的文件.py
```
然后在对话中描述错误和期望行为。

### 实现新功能

```bash
aider 相关文件1.py 相关文件2.py
```
向 AI 描述您想要实现的新功能。

### 代码重构

```bash
aider --model gpt-4o 需要重构的文件.py
```
告诉 AI 您希望如何重构代码。

### 生成测试

```bash
aider 源代码文件.py 测试文件.py
```
请求 AI 为源代码文件生成测试。

## 高级功能

### 环境变量和配置文件

Aider 支持通过环境变量或配置文件（`.aider.conf.yml`）设置各种选项。配置文件会在 Git 根目录、当前工作目录或主目录中查找。

### 使用自定义 Git 提交消息

```bash
aider --commit-prompt "自定义提交消息提示"
```

### 设置代码映射和浏览

- `--map-tokens MAP_TOKENS`：为代码库映射建议的令牌数
- `--show-repo-map`：打印代码库映射并退出

### 使用语音输入

Aider 支持语音输入功能：
- `--voice-language LANGUAGE`：指定语音使用的语言
- `--voice-format FORMAT`：语音录制的音频格式

## 故障排除

### 常见问题

1. **API 密钥问题**：确保正确设置了 API 密钥，并检查密钥是否有效。

2. **模型访问限制**：如果您无法访问某些模型，请确认您的 API 账户有权访问这些模型。

3. **Git 集成问题**：
   - 使用 `--no-git` 禁用 Git 集成
   - 确保您的 Git 仓库状态是干净的，或使用 `--dirty-commits` 允许在脏仓库中提交

4. **性能问题**：
   - 对于较小的项目，使用较轻量级的模型如 GPT-3.5-Turbo 或 Claude 3 Haiku
   - 减少提供的文件数量，专注于相关文件

### 日志和调试

使用 `-v` 或 `--verbose` 选项启用详细输出，这有助于诊断问题。

## 其他资源

- [官方文档](https://aider.chat/docs/)
- [GitHub 仓库](https://github.com/paul-gauthier/aider)
- [问题跟踪](https://github.com/paul-gauthier/aider/issues)
